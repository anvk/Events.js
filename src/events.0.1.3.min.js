// MIT licensed, Written by Abdul Khan and Alexey Novak, 2014
// version 0.1.3
var utils=utils||{};!function(){utils.Events=function(){this._init=this._init.bind(this),this._addListener=this._addListener.bind(this),this._generateToken=this._generateToken.bind(this),this.on=this.on.bind(this),this.emit=this.emit.bind(this),this.removeListener=this.removeListener.bind(this),this.removeListeners=this.removeListeners.bind(this),this._init()},utils.Events.prototype={_init:function(){this._queues={}},_generateToken:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},_addListener:function(e,t,i){if("string"!=typeof e||""===e||"function"!=typeof t)throw"Event.js: incorrect input parameters";this._queues[e]||(this._queues[e]=[]);var n=this._generateToken();return this._queues[e].push({callback:t,once:i,increment:0,token:n}),{token:n,remove:function(){this.removeListener(e,n)}.bind(this)}},on:function(e,t){return this._addListener(e,t,!1)},once:function(e,t){return this._addListener(e,t,!0)},emit:function(e,t){if(this._queues[e]&&this._queues[e].length){t=t instanceof Array?t:[t];for(var i=this._queues[e],n=i.slice(),s=i.length,r=0;s>r;r++){var u=n[r];u.once&&i.splice(r,1),"function"==typeof u.callback&&(u.callback.apply(void 0,t||[]),u.increment++)}i.length||delete this._queues[e]}},removeListener:function(e,t){if(this._queues[e]&&this._queues[e].length){for(var i=this._queues[e],n=i.length,s=0;n>s;s++)if(i[s].token===t){i.splice(s,1),n--;break}i.length||delete this._queues[e]}},removeListeners:function(e){delete this._queues[e]},_queues:null}}();